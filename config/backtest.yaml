# Backtest configuration (single-asset, single-factor CTA)

mode: combo   # single | combo

data:
  source_csv: okx_BTCUSDT_1min_data.csv
  timezone: UTC
  start: 2022-01-01 00:00:00
  end: 2025-01-01 00:00:00
  # If true, forward-fill missing bars; filled bars will have volume=0
  forward_fill: true

signals:
  factor: pvcorr
  lookback_minutes: 5000
  k_minutes: 720
  evaluate_on_rebalance_only: true
  # mapper for factor normalization into [-1,1]: zscore | sign | percentile
  mapper: percentile
  zscore_window: 100
  clip_abs_signal: 1.0
  # trade behavior: continuous | threshold
  trade_mode: threshold
  entry_long_threshold: 0.9
  entry_short_threshold: -0.9

execution:
  rebalance_minutes: 720   # default 12h
  trade_delay_minutes: 1   # trade at t+1 open
  initial_capital: 100000.0
  allow_short: false
  long_leverage: 1.0
  short_leverage: 1.0
  cost_bps: 7.0
  stop_loss_pct: 0.03

# Combo and risk control
combo:
  name: combo_pvcorr_double_ma
  factors: [pvcorr, double_ma]       # e.g., [reversal, illiq, volatility]
  weights: []       # optional; equal weights if empty

risk_control:
  enabled: false
  vol_lookback_days: 63
  vol_target_ann: 0.4
  max_gross_leverage: 1.0
  rebalance: monthly   # monthly | days
  rebalance_days: 30   # used if rebalance == days

reporting:
  out_dir: reports
  ic_rolling_window: 50
  plots: [rolling_ic, rolling_ic_cumsum, pnl, equity]
  write_results_core: false
  folder: combo_pvcorr_double_ma_0.4risk_control